const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallDisplay-0pLygltt.js","assets/main-HcGwkjfo.js","assets/main-Ds6Xydza.css","assets/TempDisplay-C97QHQ9Q.js"])))=>i.map(i=>d[i]);
import{r as c,j as e,a as y,R as v,_ as S}from"./main-HcGwkjfo.js";import{F as N}from"./Footer-DjFCRjGv.js";function T(){const[s,n]=c.useState(null);return c.useEffect(()=>{fetch("/events.json").then(a=>a.json()).then(a=>{const r=new Date;r.setHours(0,0,0,0);const l=a.map(t=>({...t,dateObj:new Date(t.date)})).filter(t=>t.dateObj>=r).sort((t,i)=>t.dateObj.getTime()-i.dateObj.getTime());l.length>0&&n(l[0])})},[]),s}function M(s){const n=new Date,a=new Date(s);return Math.ceil((a.getTime()-n.setHours(0,0,0,0))/(1e3*60*60*24))-1}function O(){const s=T(),n=new Date,a=`${n.getFullYear()}년 ${n.getMonth()+1}월 ${n.getDate()}일`,r=e.jsx("p",{className:"event-text",children:a});let l;s?l=s.name:l="예정된 행사 없음";let t;s?t=M(s.date):t=0;const i=e.jsx("p",{className:"event-text",children:l});let o=e.jsx("p",{className:"d-counter",children:"D-"+t});return t==0&&(o=e.jsx("p",{className:"d-counter",children:"D-DAY"})),e.jsxs(e.Fragment,{children:[r,i,o]})}function C(s){const{items:n,heading:a,isLoading:r,error:l}=s;let t;return r?t=e.jsx("li",{className:"list-item loading",children:"불러오는 중..."}):l?t=e.jsx("li",{className:"list-item error",children:l}):n.length===0?t=e.jsx("li",{className:"list-item",children:"항목이 없습니다."}):t=n.map(i=>e.jsx("li",{className:"list-item",children:i},i)),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"meal-heading",children:a}),e.jsx("ul",{className:"list-ul",children:t})]})}const L="05c373549f66419da390b6f0ea2c59dc",b="B10",w="7010240";function I(s,n){const[a,r]=c.useState([]),[l,t]=c.useState(!0),[i,o]=c.useState(null);return c.useEffect(()=>{let f=!1,x=0;t(!0),o(null),r([]);const h=()=>{fetch(`https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${L}&Type=json&ATPT_OFCDC_SC_CODE=${b}&SD_SCHUL_CODE=${w}&MLSV_YMD=${s}&MMEAL_SC_CODE=${n}`).then(d=>d.json()).then(d=>{var g,p,j,D,_;if(f)return;const u=((_=(D=(j=(p=(g=d==null?void 0:d.mealServiceDietInfo)==null?void 0:g[1])==null?void 0:p.row)==null?void 0:j[0])==null?void 0:D.DDISH_NM)==null?void 0:_.split("<br/>"))??[];for(let m=0;m<u.length;m++)u[m]=u[m].replace(/\([^)]*\)/g,"").trim();r(u),t(!1),o(null)}).catch(d=>{f||(x++,x<12?setTimeout(h,1e4):(t(!1),o("불러오기 실패")))})};return h(),()=>{f=!0}},[s,n]),{meals:a,isLoading:l,error:i}}const $=c.lazy(()=>S(()=>import("./CallDisplay-0pLygltt.js"),__vite__mapDeps([0,1,2]))),F=c.lazy(()=>S(()=>import("./TempDisplay-C97QHQ9Q.js"),__vite__mapDeps([3,1,2])));function P(){const s=new Date,n=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${n}${a}${r}`}function E(){return new Date().getHours()>=13?3:2}function Y(s){return s===3?"석식":"중식"}function R(){const{classId:s}=y(),[n,a]=v.useState(E()),{meals:r,isLoading:l,error:t}=I(P(),n);return v.useEffect(()=>{const i=setInterval(()=>{const o=E();o!==n&&a(o)},6e4);return()=>clearInterval(i)},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-blur"}),e.jsx("div",{className:"card-transparent food-div",children:e.jsx(C,{items:r,heading:Y(n),isLoading:l,error:t})}),e.jsxs("div",{className:"card-transparent d-counter-div",children:[e.jsx(O,{}),e.jsx(c.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:e.jsx(F,{})})]}),e.jsx("div",{className:"footer-text",children:e.jsx(N,{})}),e.jsxs("div",{className:"class-name-display",children:[s,"반"]}),e.jsx(c.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:e.jsx($,{})})]})}export{R as default};

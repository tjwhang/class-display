const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallDisplay-HuJjWcYw.js","assets/index-Dh4BDzNg.js","assets/index-t4S-MXB9.css","assets/MessageDisplay-kR26aN_y.js","assets/LongMessageDisplay-CBk0Dj2c.js","assets/TempDisplay-Bo2yiXlQ.js"])))=>i.map(i=>d[i]);
import{r as l,j as e,a as S,R as v,_ as f}from"./index-Dh4BDzNg.js";import{F as N}from"./Footer-pdzdAA5e.js";function T(){const[s,n]=l.useState(null);return l.useEffect(()=>{fetch("/events.json").then(a=>a.json()).then(a=>{const r=new Date;r.setHours(0,0,0,0);const i=a.map(t=>({...t,dateObj:new Date(t.date)})).filter(t=>t.dateObj>=r).sort((t,c)=>t.dateObj.getTime()-c.dateObj.getTime());i.length>0&&n(i[0])})},[]),s}function M(s){const n=new Date,a=new Date(s);return Math.ceil((a.getTime()-n.setHours(0,0,0,0))/(1e3*60*60*24))-1}function O(){const s=T(),n=new Date,a=`${n.getFullYear()}년 ${n.getMonth()+1}월 ${n.getDate()}일`,r=e.jsx("p",{className:"event-text",children:a});let i;s?i=s.name:i="예정된 행사 없음";let t;s?t=M(s.date):t=0;const c=e.jsx("p",{className:"event-text",children:i});let o=e.jsx("p",{className:"d-counter",children:"D-"+t});return t==0&&(o=e.jsx("p",{className:"d-counter",children:"D-DAY"})),e.jsxs(e.Fragment,{children:[r,c,o]})}function L(s){const{items:n,heading:a,isLoading:r,error:i}=s;let t;return r?t=e.jsx("li",{className:"list-item loading",children:"불러오는 중..."}):i?t=e.jsx("li",{className:"list-item error",children:i}):n.length===0?t=e.jsx("li",{className:"list-item",children:"항목이 없습니다."}):t=n.map(c=>e.jsx("li",{className:"list-item",children:c},c)),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"meal-heading",children:a}),e.jsx("ul",{className:"list-ul",children:t})]})}const I="05c373549f66419da390b6f0ea2c59dc",C="B10",b="7010240";function w(s,n){const[a,r]=l.useState([]),[i,t]=l.useState(!0),[c,o]=l.useState(null);return l.useEffect(()=>{let x=!1,p=0;t(!0),o(null),r([]);const g=()=>{fetch(`https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${I}&Type=json&ATPT_OFCDC_SC_CODE=${C}&SD_SCHUL_CODE=${b}&MLSV_YMD=${s}&MMEAL_SC_CODE=${n}`).then(d=>d.json()).then(d=>{var h,j,D,_,E;if(x)return;const u=((E=(_=(D=(j=(h=d==null?void 0:d.mealServiceDietInfo)==null?void 0:h[1])==null?void 0:j.row)==null?void 0:D[0])==null?void 0:_.DDISH_NM)==null?void 0:E.split("<br/>"))??[];for(let m=0;m<u.length;m++)u[m]=u[m].replace(/\([^)]*\)/g,"").trim();r(u),t(!1),o(null)}).catch(d=>{x||(p++,p<12?setTimeout(g,1e4):(t(!1),o("불러오기 실패")))})};return g(),()=>{x=!0}},[s,n]),{meals:a,isLoading:i,error:c}}const $=l.lazy(()=>f(()=>import("./CallDisplay-HuJjWcYw.js"),__vite__mapDeps([0,1,2]))),P=l.lazy(()=>f(()=>import("./MessageDisplay-kR26aN_y.js"),__vite__mapDeps([3,1,2]))),A=l.lazy(()=>f(()=>import("./LongMessageDisplay-CBk0Dj2c.js"),__vite__mapDeps([4,1,2]))),F=l.lazy(()=>f(()=>import("./TempDisplay-Bo2yiXlQ.js"),__vite__mapDeps([5,1,2])));function R(){const s=new Date,n=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${n}${a}${r}`}function y(){return new Date().getHours()>=13?3:2}function Y(s){return s===3?"석식":"중식"}function z(){const{classId:s}=S(),[n,a]=v.useState(y()),{meals:r,isLoading:i,error:t}=w(R(),n);return v.useEffect(()=>{const c=setInterval(()=>{const o=y();o!==n&&a(o)},6e4);return()=>clearInterval(c)},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-blur"}),e.jsx("div",{className:"card-transparent food-div",children:e.jsx(L,{items:r,heading:Y(n),isLoading:i,error:t})}),e.jsxs("div",{className:"card-transparent d-counter-div",children:[e.jsx(O,{}),e.jsx(l.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:e.jsx(F,{})})]}),e.jsx("div",{className:"footer-text",children:e.jsx(N,{})}),"      ",e.jsxs("div",{className:"class-name-display",children:[s,"반"]}),e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:[e.jsx($,{}),e.jsx(P,{}),e.jsx(A,{})]})]})}export{z as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CallDisplay-BBT6yDzI.js","assets/index-DUO3hN4v.js","assets/index-C8jj41if.css","assets/MessageDisplay-D3PEJltj.js","assets/TempDisplay-Dgilvdge.js"])))=>i.map(i=>d[i]);
import{r as i,j as e,a as S,R as E,_ as x}from"./index-DUO3hN4v.js";import{F as N}from"./Footer-C-mZJSc6.js";function T(){const[s,n]=i.useState(null);return i.useEffect(()=>{fetch("/events.json").then(a=>a.json()).then(a=>{const r=new Date;r.setHours(0,0,0,0);const l=a.map(t=>({...t,dateObj:new Date(t.date)})).filter(t=>t.dateObj>=r).sort((t,c)=>t.dateObj.getTime()-c.dateObj.getTime());l.length>0&&n(l[0])})},[]),s}function M(s){const n=new Date,a=new Date(s);return Math.ceil((a.getTime()-n.setHours(0,0,0,0))/(1e3*60*60*24))-1}function O(){const s=T(),n=new Date,a=`${n.getFullYear()}년 ${n.getMonth()+1}월 ${n.getDate()}일`,r=e.jsx("p",{className:"event-text",children:a});let l;s?l=s.name:l="예정된 행사 없음";let t;s?t=M(s.date):t=0;const c=e.jsx("p",{className:"event-text",children:l});let o=e.jsx("p",{className:"d-counter",children:"D-"+t});return t==0&&(o=e.jsx("p",{className:"d-counter",children:"D-DAY"})),e.jsxs(e.Fragment,{children:[r,c,o]})}function L(s){const{items:n,heading:a,isLoading:r,error:l}=s;let t;return r?t=e.jsx("li",{className:"list-item loading",children:"불러오는 중..."}):l?t=e.jsx("li",{className:"list-item error",children:l}):n.length===0?t=e.jsx("li",{className:"list-item",children:"항목이 없습니다."}):t=n.map(c=>e.jsx("li",{className:"list-item",children:c},c)),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"meal-heading",children:a}),e.jsx("ul",{className:"list-ul",children:t})]})}const C="05c373549f66419da390b6f0ea2c59dc",I="B10",b="7010240";function w(s,n){const[a,r]=i.useState([]),[l,t]=i.useState(!0),[c,o]=i.useState(null);return i.useEffect(()=>{let f=!1,h=0;t(!0),o(null),r([]);const p=()=>{fetch(`https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${C}&Type=json&ATPT_OFCDC_SC_CODE=${I}&SD_SCHUL_CODE=${b}&MLSV_YMD=${s}&MMEAL_SC_CODE=${n}`).then(d=>d.json()).then(d=>{var g,j,D,_,v;if(f)return;const u=((v=(_=(D=(j=(g=d==null?void 0:d.mealServiceDietInfo)==null?void 0:g[1])==null?void 0:j.row)==null?void 0:D[0])==null?void 0:_.DDISH_NM)==null?void 0:v.split("<br/>"))??[];for(let m=0;m<u.length;m++)u[m]=u[m].replace(/\([^)]*\)/g,"").trim();r(u),t(!1),o(null)}).catch(d=>{f||(h++,h<12?setTimeout(p,1e4):(t(!1),o("불러오기 실패")))})};return p(),()=>{f=!0}},[s,n]),{meals:a,isLoading:l,error:c}}const $=i.lazy(()=>x(()=>import("./CallDisplay-BBT6yDzI.js"),__vite__mapDeps([0,1,2]))),F=i.lazy(()=>x(()=>import("./MessageDisplay-D3PEJltj.js"),__vite__mapDeps([3,1,2]))),P=i.lazy(()=>x(()=>import("./TempDisplay-Dgilvdge.js"),__vite__mapDeps([4,1,2])));function A(){const s=new Date,n=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${n}${a}${r}`}function y(){return new Date().getHours()>=13?3:2}function R(s){return s===3?"석식":"중식"}function V(){const{classId:s}=S(),[n,a]=E.useState(y()),{meals:r,isLoading:l,error:t}=w(A(),n);return E.useEffect(()=>{const c=setInterval(()=>{const o=y();o!==n&&a(o)},6e4);return()=>clearInterval(c)},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-blur"}),e.jsx("div",{className:"card-transparent food-div",children:e.jsx(L,{items:r,heading:R(n),isLoading:l,error:t})}),e.jsxs("div",{className:"card-transparent d-counter-div",children:[e.jsx(O,{}),e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:e.jsx(P,{})})]}),e.jsx("div",{className:"footer-text",children:e.jsx(N,{})}),"      ",e.jsxs("div",{className:"class-name-display",children:[s,"반"]}),e.jsxs(i.Suspense,{fallback:e.jsx("div",{children:"Loading components..."}),children:[e.jsx($,{}),e.jsx(F,{})]})]})}export{V as default};
